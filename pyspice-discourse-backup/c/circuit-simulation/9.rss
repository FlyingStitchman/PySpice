<?xml version="1.0" encoding="UTF-8" ?>
<rss version="2.0" xmlns:discourse="http://www.discourse.org/" xmlns:atom="http://www.w3.org/2005/Atom" xmlns:dc="http://purl.org/dc/elements/1.1/">
  <channel>
    <title>Circuit Simulation - PySpice</title>
    <link>https://pyspice.discourse.group/c/circuit-simulation/9</link>
    <description>Topics in the &#39;Circuit Simulation&#39; category </description>
    
      <lastBuildDate>Thu, 13 Jan 2022 03:55:35 +0000</lastBuildDate>
      <atom:link href="https://pyspice.discourse.group/c/circuit-simulation/9.rss" rel="self" type="application/rss+xml" />
        <item>
          <title>Simulating a circuit with 16 MOSFETs: True gmin stepping error</title>
          <dc:creator><![CDATA[dsalman]]></dc:creator>
          <category>Circuit Simulation</category>
          <description><![CDATA[
            <p>Hello,</p>
<p>I am trying to simulate a circuit using 16 MOSFETS.</p>
<p>The issue is that once the MOSFETS’s 15 and 16 are placed in the schematic, it results in an error: PySpice.Spice.NgSpice.Shared.NgSpiceShared - Shared.ERROR</p>
<p>If the MOSFET’s 15 and 16 are commented out, then the code compiles.</p>
<p>I am using NGspice-34.dll and PySpice 1.5. Have also tested with Pyspice 1.4.3 and NGspice-32.dll.</p>
<p>Is NGSpice reaching some maximum nodes/complexity limit? OR is this an issue with mosfet model? OR it is a circuit netlist (floating node?) issue?</p>
<p>Any help or ideas would be greatly appreciated.</p>
<p>The code and error message are reproduced below.</p>
<p>Thanks</p>
<p>Kahless96</p>
<p>##***********************************************<br>
import math<br>
import numpy as np<br>
import matplotlib.pyplot as plt<br>
from matplotlib.widgets import Cursor<br>
from matplotlib.pyplot import semilogx<br>
from matplotlib import pyplot</p>
<p>import PySpice.Logging.Logging as Logging<br>
logger = Logging.setup_logging()</p>
<p>from PySpice.Doc.ExampleTools import find_libraries<br>
from PySpice.Probe.Plot import plot<br>
from PySpice.Spice.Library import SpiceLibrary<br>
from PySpice.Spice.Netlist import Circuit<br>
from PySpice.Unit import *</p>
<p>from engineering_notation import EngNumber</p>
<p>##***********************************************</p>
<h2>
<a name="circuit-netlist-1" class="anchor" href="https://pyspice.discourse.group#circuit-netlist-1"></a>Circuit Netlist</h2>
<p>circuit = Circuit(‘MyCircuit’)</p>
<p>libraries_path = find_libraries()<br>
spice_library = SpiceLibrary(libraries_path)<br>
circuit.include(spice_library[‘ptm65nm_nmos’])<br>
circuit.include(spice_library[‘ptm65nm_pmos’])</p>
<h1>
<a name="define-inputs-2" class="anchor" href="https://pyspice.discourse.group#define-inputs-2"></a>Define inputs</h1>
<p>HIGH = 1@u_V<br>
LOW = 0@u_V<br>
f_D = 1@u_Hz<br>
f_C = f_D/2<br>
f_B = f_D/4<br>
f_A = f_D/8</p>
<p>steptime=1@u_ms<br>
finaltime = 8/f_D<br>
circuit.V(1, ‘Vdd’, circuit.gnd,       HIGH@u_V)<br>
circuit.PulseVoltageSource(2, ‘A’, circuit.gnd,<br>
initial_value=HIGH, pulsed_value=LOW,<br>
pulse_width=(1/f_A)/2, period=1/f_A)<br>
circuit.PulseVoltageSource(3, ‘B’, circuit.gnd,<br>
initial_value=HIGH, pulsed_value=LOW,<br>
pulse_width=(1/f_B)/2, period=1/f_B)<br>
circuit.PulseVoltageSource(4, ‘C’, circuit.gnd,<br>
initial_value=HIGH, pulsed_value=LOW,<br>
pulse_width=(1/f_C)/2, period=1/f_C)<br>
circuit.PulseVoltageSource(5, ‘D’, circuit.gnd,<br>
initial_value=HIGH, pulsed_value=LOW,<br>
pulse_width=(1/f_D)/2, period=1/f_D)</p>
<h1>
<a name="m-name-drain-node-gate-node-source-node-bulksubstrate-node-3" class="anchor" href="https://pyspice.discourse.group#m-name-drain-node-gate-node-source-node-bulksubstrate-node-3"></a>M    <source> &lt;bulk/substrate node&gt;
</h1>
<p>circuit.MOSFET(1, ‘out1’, ‘A’, ‘Vdd’, ‘Vdd’, model=‘ptm65nm_pmos’)<br>
circuit.MOSFET(2, ‘out1’, ‘B’, ‘Vdd’, ‘Vdd’, model=‘ptm65nm_pmos’)<br>
circuit.MOSFET(3, ‘out1’, ‘A’, ‘temp’, circuit.gnd, model=‘ptm65nm_nmos’)<br>
circuit.MOSFET(4, ‘temp’,‘B’, circuit.gnd, circuit.gnd, model=‘ptm65nm_nmos’)<br>
circuit.MOSFET(5, ‘out2’, ‘out1’, circuit.gnd, circuit.gnd, model=‘ptm65nm_nmos’)<br>
circuit.MOSFET(6, ‘out2’, ‘out1’, ‘Vdd’, ‘Vdd’, model=‘ptm65nm_pmos’)<br>
circuit.MOSFET(7, ‘out3’, ‘C’, ‘Vdd’, ‘Vdd’, model=‘ptm65nm_pmos’)<br>
circuit.MOSFET(8, ‘out3’, ‘D’, ‘Vdd’, ‘Vdd’, model=‘ptm65nm_pmos’)<br>
circuit.MOSFET(9, ‘out3’, ‘C’, ‘temp1’, circuit.gnd, model=‘ptm65nm_nmos’)<br>
circuit.MOSFET(10, ‘temp1’,‘D’, circuit.gnd, circuit.gnd, model=‘ptm65nm_nmos’)<br>
circuit.MOSFET(11, ‘out4’, ‘out3’, circuit.gnd, circuit.gnd, model=‘ptm65nm_nmos’)<br>
circuit.MOSFET(12, ‘out4’, ‘out3’, ‘Vdd’, ‘Vdd’, model=‘ptm65nm_pmos’)<br>
circuit.MOSFET(13, ‘op’, ‘out2’, ‘Vdd’, ‘Vdd’, model=‘ptm65nm_pmos’)<br>
circuit.MOSFET(14, ‘op’, ‘out4’, ‘Vdd’, ‘Vdd’, model=‘ptm65nm_pmos’)<br>
circuit.MOSFET(15, ‘op’, ‘out2’, ‘temp2’, circuit.gnd, model=‘ptm65nm_nmos’)<br>
circuit.MOSFET(16, ‘temp2’,‘out4’, circuit.gnd, circuit.gnd, model=‘ptm65nm_nmos’)</p>
<p>##***********************************************</p>
<h2>
<a name="simulation-transient-analysis-4" class="anchor" href="https://pyspice.discourse.group#simulation-transient-analysis-4"></a>Simulation: Transient Analysis</h2>
<p>simulator = circuit.simulator(temperature=25, nominal_temperature=25)<br>
analysis = simulator.transient(step_time=steptime, end_time=finaltime)</p>
<p>#########################</p>
<h1>
<a name="plotting-commands-5" class="anchor" href="https://pyspice.discourse.group#plotting-commands-5"></a>PLOTTING COMMANDS</h1>
<p>figure = plt.subplots(figsize=(11, 6))<br>
axe = plt.subplot(111)<br>
plt.xlabel(‘Time [s]’)<br>
plt.ylabel(‘Voltage [V]’)<br>
plt.grid()<br>
plot(analysis[‘op’], axis=axe, color=‘red’)<br>
plt.show()</p>
<p>Here is the error messages after which it fails to run:</p>
<p>2022-01-13 14:24:25,298 - PySpice.Spice.NgSpice.Shared.NgSpiceShared - Shared.ERROR - Note: Starting true gmin stepping<br>
2022-01-13 14:24:25,298 - PySpice.Spice.NgSpice.Shared.NgSpiceShared - Shared.ERROR - Trying gmin =   1.0000E-03 Note: One successful gmin step<br>
2022-01-13 14:24:25,298 - PySpice.Spice.NgSpice.Shared.NgSpiceShared - Shared.ERROR - Trying gmin =   1.0000E-04 Note: One successful gmin step<br>
2022-01-13 14:24:25,298 - PySpice.Spice.NgSpice.Shared.NgSpiceShared - Shared.ERROR - Trying gmin =   1.0000E-05 Note: One successful gmin step<br>
2022-01-13 14:24:25,298 - PySpice.Spice.NgSpice.Shared.NgSpiceShared - Shared.ERROR - Trying gmin =   1.0000E-06 Note: One successful gmin step<br>
2022-01-13 14:24:25,298 - PySpice.Spice.NgSpice.Shared.NgSpiceShared - Shared.ERROR - Trying gmin =   1.0000E-07 Note: One successful gmin step<br>
2022-01-13 14:24:25,298 - PySpice.Spice.NgSpice.Shared.NgSpiceShared - Shared.ERROR - Trying gmin =   1.0000E-08 Note: One successful gmin step<br>
2022-01-13 14:24:25,298 - PySpice.Spice.NgSpice.Shared.NgSpiceShared - Shared.ERROR - Trying gmin =   1.0000E-09 Note: One successful gmin step<br>
2022-01-13 14:24:25,314 - PySpice.Spice.NgSpice.Shared.NgSpiceShared - Shared.ERROR - Trying gmin =   1.0000E-10 Note: One successful gmin step<br>
2022-01-13 14:24:25,314 - PySpice.Spice.NgSpice.Shared.NgSpiceShared - Shared.ERROR - Trying gmin =   1.0000E-11 Note: One successful gmin step<br>
2022-01-13 14:24:25,314 - PySpice.Spice.NgSpice.Shared.NgSpiceShared - Shared.ERROR - Trying gmin =   1.0000E-12 Note: One successful gmin step<br>
2022-01-13 14:24:25,314 - PySpice.Spice.NgSpice.Shared.NgSpiceShared - Shared.ERROR - Trying gmin =   1.0000E-12 Note: One successful gmin step<br>
2022-01-13 14:24:25,314 - PySpice.Spice.NgSpice.Shared.NgSpiceShared - Shared.ERROR - Note: True gmin stepping completed</p>
<p>I have seen this gmin stepping error in other forum posts but in those cases it was related to circuit netlist error. This does not seem to be the case here.</p>
<p>The mosfet models being used are provided with Pyspice.</p>
            <p><small>2 posts - 1 participant</small></p>
            <p><a href="https://pyspice.discourse.group/t/simulating-a-circuit-with-16-mosfets-true-gmin-stepping-error/162">Read full topic</a></p>
          ]]></description>
          <link>https://pyspice.discourse.group/t/simulating-a-circuit-with-16-mosfets-true-gmin-stepping-error/162</link>
          <pubDate>Thu, 13 Jan 2022 03:55:35 +0000</pubDate>
          <discourse:topicPinned>No</discourse:topicPinned>
          <discourse:topicClosed>No</discourse:topicClosed>
          <discourse:topicArchived>No</discourse:topicArchived>
          <guid isPermaLink="false">pyspice.discourse.group-topic-162</guid>
          <source url="https://pyspice.discourse.group/t/simulating-a-circuit-with-16-mosfets-true-gmin-stepping-error/162.rss">Simulating a circuit with 16 MOSFETs: True gmin stepping error</source>
        </item>
        <item>
          <title>How to write .func in pyspice and use it in behavioral source?</title>
          <dc:creator><![CDATA[sant]]></dc:creator>
          <category>Circuit Simulation</category>
          <description><![CDATA[
            <p>I want to write a .func that will help me designing a device model. I used **raw_spice=’ …’ **  but it is not working. I am new in pyspice.</p>
<p>Thank yuo</p>
            <p><small>1 post - 1 participant</small></p>
            <p><a href="https://pyspice.discourse.group/t/how-to-write-func-in-pyspice-and-use-it-in-behavioral-source/148">Read full topic</a></p>
          ]]></description>
          <link>https://pyspice.discourse.group/t/how-to-write-func-in-pyspice-and-use-it-in-behavioral-source/148</link>
          <pubDate>Thu, 16 Sep 2021 00:26:03 +0000</pubDate>
          <discourse:topicPinned>No</discourse:topicPinned>
          <discourse:topicClosed>No</discourse:topicClosed>
          <discourse:topicArchived>No</discourse:topicArchived>
          <guid isPermaLink="false">pyspice.discourse.group-topic-148</guid>
          <source url="https://pyspice.discourse.group/t/how-to-write-func-in-pyspice-and-use-it-in-behavioral-source/148.rss">How to write .func in pyspice and use it in behavioral source?</source>
        </item>
        <item>
          <title>Interrupted simulation multiple sources</title>
          <dc:creator><![CDATA[tombalabomba]]></dc:creator>
          <category>Circuit Simulation</category>
          <description><![CDATA[
            <p>Hi everyone,</p>
<p>for a research project I’m working on control strategies for PFC circuits and therefore I need to simulate a passive circuit in conjunction with two half bridges.<br>
Problem is that I need the simulation to interact with a python script since I need to calculate the control signals of the two half bridges externally and thus the simualtion flow is as follows.</p>
<p>First, I need to initialize the simulation which basically means that I need to sample the amplitude and phase of a sinusodial source representing the grid voltage and the component values and initial conditions of the passive components. Next, I need to run the simulation in chunks where I first calculate the four control signals of the half bridges based on the current and voltage signals of the passive circuit followed by a chunk of transient simulation for a given time span (sample rate of the controller).</p>
<p>I tried to implement this flow but I unfortunately I struggle with the following issues.</p>
<p>a) Phase of the AC source:<br>
I tired SinusoidalVoltageSource() but I failed to specify a phase offset. Altough it’s base class SinusoidalMixin() offers a delay attribute, it seems that it just enables the source after a given time and thus this isn’t the desired behaviour for my purpose. Alternatively, I defined my own grid voltage using a NgSpiceShared object according …/examples/ngspice-shared/external-source.html.<br>
This essential does the trick for me but leaves with the next problem.</p>
<p>b) Multiple External Sources:<br>
Give the simulation flow above I need to run the simulation with at least four external sources, two for every half bridge, and five if I define the grid voltage also as external source. So I wonder how I define multiple shared objects.</p>
<p>c) Setting the initial conditions<br>
Since I run the simulation in chunks I wonder if I have to preload the nodes with the latest values and I need to run the simulation with start_time=0 and end_time=timespan according the controller’s sample rate or are the states kept internally and I need just to run the simulation with start_time=(k-1)<em>timespan, end_time=k</em>timespan in order to run the kth simulation chunk.</p>
<p>Any help is kindly appreciated!</p>
            <p><small>1 post - 1 participant</small></p>
            <p><a href="https://pyspice.discourse.group/t/interrupted-simulation-multiple-sources/144">Read full topic</a></p>
          ]]></description>
          <link>https://pyspice.discourse.group/t/interrupted-simulation-multiple-sources/144</link>
          <pubDate>Wed, 11 Aug 2021 15:05:52 +0000</pubDate>
          <discourse:topicPinned>No</discourse:topicPinned>
          <discourse:topicClosed>No</discourse:topicClosed>
          <discourse:topicArchived>No</discourse:topicArchived>
          <guid isPermaLink="false">pyspice.discourse.group-topic-144</guid>
          <source url="https://pyspice.discourse.group/t/interrupted-simulation-multiple-sources/144.rss">Interrupted simulation multiple sources</source>
        </item>
        <item>
          <title>Simulating Dependent Sources (CCVS works but VCVS does not?!)</title>
          <dc:creator><![CDATA[dsalman]]></dc:creator>
          <category>Circuit Simulation</category>
          <description><![CDATA[
            <p>Hello,</p>
<p>I am trying to run the following code for the circuit:<img src="https://aws1.discourse-cdn.com/free1/uploads/pyspice/original/1X/f64e6081e7b1e978c67c509c0bc720c59812d89b.jpeg" alt="Circuit" data-base62-sha1="z8VnxkVFbzhUCrIYUKthum2afhN" width="530" height="232"></p>
<p>###############################################################</p>
<p>import PySpice.Logging.Logging as Logging<br>
logger = Logging.setup_logging()</p>
<p>################################################################</p>
<p>from PySpice.Spice.Netlist import Circuit<br>
from PySpice.Unit import *</p>
<p>#################################################################</p>
<p>circuit = Circuit(‘Circuit with VCVS’)</p>
<p>circuit.R(1, 1, circuit.gnd, 6@u_Ω)<br>
circuit.R(2, 2, 3,           4@u_Ω)<br>
circuit.R(3, 3, 4,           8@u_Ω)<br>
circuit.R(4, 5, circuit.gnd, 15@u_Ω)<br>
circuit.V(1, 2, 1,           65@u_V)<br>
circuit.E(1, 4, 3, 2, 3, 3)</p>
<p>simulator = circuit.simulator(temperature=25, nominal_temperature=25)<br>
analysis = simulator.operating_point()</p>
<p>for node in analysis.nodes.values():<br>
print(‘Node {}: {:4.1f} V’.format(str(node), float(node)))</p>
<p>When I run, it gives an error:</p>
<p>Traceback (most recent call last):<br>
File “C:\Users\AppData\Local\Programs\Python\Python39\lib\site-packages\PySpice\Spice\Netlist.py”, line 928, in <strong>getattr</strong><br>
return self.<strong>getitem</strong>(attribute_name)<br>
File “C:\Users\AppData\Local\Programs\Python\Python39\lib\site-packages\PySpice\Spice\Netlist.py”, line 921, in <strong>getitem</strong><br>
raise IndexError(attribute_name) # KeyError<br>
IndexError: E</p>
<p>During handling of the above exception, another exception occurred:</p>
<p>Traceback (most recent call last):<br>
File “C:/Users/Desktop/PySpice/node-voltage-method-example8.py”, line 22, in <br>
circuit.E(1, 4, 3, 2, 3, 3)<br>
File “C:\Users\AppData\Local\Programs\Python\Python39\lib\site-packages\PySpice\Spice\Netlist.py”, line 930, in <strong>getattr</strong><br>
raise AttributeError(attribute_name)<br>
AttributeError: E</p>
<p>I am not sure where I am going wrong. I have been able to simulate a CCVS (part name H) but all other dependent sources seem to give an error.</p>
<p>Can anyone please point out what is wrong in the code above?</p>
<p>Thanks</p>
<p>Salman</p>
            <p><small>6 posts - 2 participants</small></p>
            <p><a href="https://pyspice.discourse.group/t/simulating-dependent-sources-ccvs-works-but-vcvs-does-not/105">Read full topic</a></p>
          ]]></description>
          <link>https://pyspice.discourse.group/t/simulating-dependent-sources-ccvs-works-but-vcvs-does-not/105</link>
          <pubDate>Wed, 02 Dec 2020 01:58:43 +0000</pubDate>
          <discourse:topicPinned>No</discourse:topicPinned>
          <discourse:topicClosed>No</discourse:topicClosed>
          <discourse:topicArchived>No</discourse:topicArchived>
          <guid isPermaLink="false">pyspice.discourse.group-topic-105</guid>
          <source url="https://pyspice.discourse.group/t/simulating-dependent-sources-ccvs-works-but-vcvs-does-not/105.rss">Simulating Dependent Sources (CCVS works but VCVS does not?!)</source>
        </item>
        <item>
          <title>Is there a way to manipulate parameter during the simulation</title>
          <dc:creator><![CDATA[RNWx]]></dc:creator>
          <category>Circuit Simulation</category>
          <description><![CDATA[
            <p>Hello everyone,</p>
<p>ist it possible to ‘pause’ the simulation, get values of certain voltages or currents manipulate them and put them back into the simulation?</p>
<p>For example to implement a digital controller or something like that.</p>
<p>Thank you for any help.</p>
<p>Kind regards<br>
RNWx</p>
            <p><small>1 post - 1 participant</small></p>
            <p><a href="https://pyspice.discourse.group/t/is-there-a-way-to-manipulate-parameter-during-the-simulation/72">Read full topic</a></p>
          ]]></description>
          <link>https://pyspice.discourse.group/t/is-there-a-way-to-manipulate-parameter-during-the-simulation/72</link>
          <pubDate>Wed, 19 Aug 2020 09:46:34 +0000</pubDate>
          <discourse:topicPinned>No</discourse:topicPinned>
          <discourse:topicClosed>No</discourse:topicClosed>
          <discourse:topicArchived>No</discourse:topicArchived>
          <guid isPermaLink="false">pyspice.discourse.group-topic-72</guid>
          <source url="https://pyspice.discourse.group/t/is-there-a-way-to-manipulate-parameter-during-the-simulation/72.rss">Is there a way to manipulate parameter during the simulation</source>
        </item>
        <item>
          <title>Inputing data from python model into ngspice shared netlist</title>
          <dc:creator><![CDATA[hteixeira]]></dc:creator>
          <category>Circuit Simulation</category>
          <description><![CDATA[
            <p>Hello,</p>
<p>I’ve been trying to simulate a model of a neuron coupled to a microelectrode in ngspice. However, while the microelectrode is easy to simulate the neuronal model is quite difficult. As such, when I found pyspice I thought maybe I could use the netlist I already have for the microelectrode and create the neuron model in python and use the output voltage of the neuron model as an input in the microelectrode model.<br>
I’ve read through all the examples and some documentation and even used the <a href="https://pyspice.fabrice-salvaire.fr/releases/v1.4/examples/ngspice-shared/ngspice-interpreter.html" rel="nofollow noopener">ngspice shared interpreter example</a> with my microelectrode netlist but I cannot even find a way of just plotting the circuits transient analysis (without the neuron model) as I did with ngspice.</p>
<p>To summarize, my questions are:</p>
<ol>
<li>Can I use my already written netlist of the microelectrode with the ngspice shared option ?</li>
<li>To interface the neuron model that I will write in python as source voltage for the microelectrode does it mean that I have to re-write the netlist into pyspyce nomenclature ?</li>
</ol>
<p>PS: I can provide my netlist if necessary.</p>
<p>Thank you for your time.</p>
            <p><small>1 post - 1 participant</small></p>
            <p><a href="https://pyspice.discourse.group/t/inputing-data-from-python-model-into-ngspice-shared-netlist/66">Read full topic</a></p>
          ]]></description>
          <link>https://pyspice.discourse.group/t/inputing-data-from-python-model-into-ngspice-shared-netlist/66</link>
          <pubDate>Mon, 03 Aug 2020 11:05:01 +0000</pubDate>
          <discourse:topicPinned>No</discourse:topicPinned>
          <discourse:topicClosed>No</discourse:topicClosed>
          <discourse:topicArchived>No</discourse:topicArchived>
          <guid isPermaLink="false">pyspice.discourse.group-topic-66</guid>
          <source url="https://pyspice.discourse.group/t/inputing-data-from-python-model-into-ngspice-shared-netlist/66.rss">Inputing data from python model into ngspice shared netlist</source>
        </item>
        <item>
          <title>Transistor Example</title>
          <dc:creator><![CDATA[Vinnegans]]></dc:creator>
          <category>Circuit Simulation</category>
          <description><![CDATA[
            <p>In the example 8.20.1 AC Coupled Amplifier, when I was trying to run the code in Jupyter Notebook</p>
<blockquote>
<p>simulator = circuit.simulator(temperature=25, nominal_temperature=25)</p>
</blockquote>
<p>it shows:</p>
<hr>
<blockquote>
<p>OSError                                   Traceback (most recent call last)<br>
 in <br>
----&gt; 1 simulator = circuit.simulator(temperature=25, nominal_temperature=25)</p>
<p>~/anaconda3/envs/Circuits/lib/python3.6/site-packages/PySpice/Spice/Netlist.py in simulator(self, *args, **kwargs)<br>
1297<br>
1298     def simulator(self, *args, **kwargs):<br>
-&gt; 1299         return CircuitSimulator.factory(self, *args, **kwargs)</p>
<p>~/anaconda3/envs/Circuits/lib/python3.6/site-packages/PySpice/Spice/Simulation.py in factory(cls, circuit, *args, **kwargs)<br>
1117<br>
1118         if sub_cls is not None:<br>
-&gt; 1119             return sub_cls(circuit, *args, **kwargs)<br>
1120         else:<br>
1121             raise ValueError(‘Unknown simulator type’)</p>
<p>~/anaconda3/envs/Circuits/lib/python3.6/site-packages/PySpice/Spice/NgSpice/Simulation.py in <strong>init</strong>(self, circuit, **kwargs)<br>
97         ngspice_shared = kwargs.get(‘ngspice_shared’, None)<br>
98         if ngspice_shared is None:<br>
—&gt; 99             self._ngspice_shared = NgSpiceShared.new_instance()<br>
100         else:<br>
101             self._ngspice_shared = ngspice_shared</p>
<p>~/anaconda3/envs/Circuits/lib/python3.6/site-packages/PySpice/Spice/NgSpice/Shared.py in new_instance(cls, ngspice_id, send_data, verbose)<br>
450         else:<br>
451             cls._logger.debug(“New instance for id {}”.format(ngspice_id))<br>
–&gt; 452             instance = cls(ngspice_id=ngspice_id, send_data=send_data, verbose=verbose)<br>
453             cls._instances[ngspice_id] = instance<br>
454             return instance</p>
<p>~/anaconda3/envs/Circuits/lib/python3.6/site-packages/PySpice/Spice/NgSpice/Shared.py in <strong>init</strong>(self, ngspice_id, send_data, verbose)<br>
478<br>
479         self._library_path = None<br>
–&gt; 480         self._load_library(verbose)<br>
481         self._init_ngspice(send_data)<br>
482</p>
<p>~/anaconda3/envs/Circuits/lib/python3.6/site-packages/PySpice/Spice/NgSpice/Shared.py in _load_library(self, verbose)<br>
538         if verbose:<br>
539             print(message)<br>
–&gt; 540         self._ngspice_shared = ffi.dlopen(self.library_path)<br>
541<br>
542         # Note: cannot yet execute command</p>
<p>~/anaconda3/envs/Circuits/lib/python3.6/site-packages/cffi/api.py in dlopen(self, name, flags)<br>
148                             “or an already-opened ‘void *’ handle”)<br>
149         with self._lock:<br>
–&gt; 150             lib, function_cache = _make_ffi_library(self, name, flags)<br>
151             self._function_caches.append(function_cache)<br>
152             self._libraries.append(lib)</p>
<p>~/anaconda3/envs/Circuits/lib/python3.6/site-packages/cffi/api.py in _make_ffi_library(ffi, libname, flags)<br>
830 def _make_ffi_library(ffi, libname, flags):<br>
831     backend = ffi._backend<br>
–&gt; 832     backendlib = _load_backend_lib(backend, libname, flags)<br>
833     #<br>
834     def accessor_function(name):</p>
<p>~/anaconda3/envs/Circuits/lib/python3.6/site-packages/cffi/api.py in _load_backend_lib(backend, name, flags)<br>
825         if first_error is not None:<br>
826             msg = “%s.  Additionally, %s” % (first_error, msg)<br>
–&gt; 827         raise OSError(msg)<br>
828     return backend.load_library(path, flags)<br>
829</p>
<p>OSError: cannot load library ‘libngspice.dylib’: dlopen(libngspice.dylib, 2): image not found.  Additionally, ctypes.util.find_library() did not manage to locate a library called ‘libngspice.dylib’</p>
</blockquote>
            <p><small>1 post - 1 participant</small></p>
            <p><a href="https://pyspice.discourse.group/t/transistor-example/63">Read full topic</a></p>
          ]]></description>
          <link>https://pyspice.discourse.group/t/transistor-example/63</link>
          <pubDate>Fri, 31 Jul 2020 05:27:09 +0000</pubDate>
          <discourse:topicPinned>No</discourse:topicPinned>
          <discourse:topicClosed>No</discourse:topicClosed>
          <discourse:topicArchived>No</discourse:topicArchived>
          <guid isPermaLink="false">pyspice.discourse.group-topic-63</guid>
          <source url="https://pyspice.discourse.group/t/transistor-example/63.rss">Transistor Example</source>
        </item>
        <item>
          <title>XSPICE elements in PySpice</title>
          <dc:creator><![CDATA[scbist]]></dc:creator>
          <category>Circuit Simulation</category>
          <description><![CDATA[
            <p>Good afternoon!<br>
I’m trying to model a simple electrical circuit with XSPICE elements. For example, the electrical circuit from Chapter 27.1 (Ngspice user manual):</p>
<pre><code>from PySpice.Spice.Netlist import Circuit

test = """XSPICE
Vin1 1 0 DC 0V AC 1.0 SIN(0V 1V 1000Hz)
Ccouple 1 in 0.000001
Rzin in 0 19.35k
Aamp in aout gain_block
.model gain_block gain (gain=-3.9 out_offset=7.003)
Rzout aout coll 3.9k
Rbig coll 0 1e12
.control
run
display
tran 0.00001 0.003
plot i(Vin1)
.endc
.end
"""
circuit = Circuit(test)

simulator = circuit.simulator(temperature=27, nominal_temperature=27)
analysis = simulator.transient(step_time=0.00001, end_time=0.003)
</code></pre>
<p>When I try to run it I get an error:</p>
<pre><code>  File ".../.local/lib/python3.7/site-packages/PySpice/Spice/RawFile.py", line 223, in _read_header_line
    raise NameError("Unexpected line: %s" % (line))
NameError: Unexpected line: Reducing trtol to 1 for xspice 'A' devices
</code></pre>
<p>So there are two questions:</p>
<ol>
<li>If I understand correctly, the error is caused by the ngspice message “Reducing trtol to 1 for xspice ‘A’ devices”. Is it possible to avoid this error? When adding a line “option trtol=1” after the line “.control” I get the following error:<br>
<code>NameError: Expected label Title instead of No. of Data Rows</code>
</li>
<li>Is it possible to set the value of trtol and other Simulator Variables by using any pyspice command?</li>
</ol>
<p>I am using Spyder 4, PySpice 1.4.3 and ngspice-30 (DEFAULT_SIMULATOR = ‘ngspice-subprocess’) in the Debian linux operating system.</p>
<p>Thank you in advance!</p>
<p>–<br>
Regards,<br>
Dmitriy N.</p>
            <p><small>6 posts - 4 participants</small></p>
            <p><a href="https://pyspice.discourse.group/t/xspice-elements-in-pyspice/61">Read full topic</a></p>
          ]]></description>
          <link>https://pyspice.discourse.group/t/xspice-elements-in-pyspice/61</link>
          <pubDate>Sat, 11 Jul 2020 16:18:54 +0000</pubDate>
          <discourse:topicPinned>No</discourse:topicPinned>
          <discourse:topicClosed>No</discourse:topicClosed>
          <discourse:topicArchived>No</discourse:topicArchived>
          <guid isPermaLink="false">pyspice.discourse.group-topic-61</guid>
          <source url="https://pyspice.discourse.group/t/xspice-elements-in-pyspice/61.rss">XSPICE elements in PySpice</source>
        </item>
        <item>
          <title>AttributeError: type object &#39;NgSpiceShared&#39; has no attribute &#39;new_instance&#39;</title>
          <dc:creator><![CDATA[tadeus]]></dc:creator>
          <category>Circuit Simulation</category>
          <description><![CDATA[
            <p>good afternoon community among my adventure to simulate an example of the pyspice module I ran into the following error:<br>
---------------------------------------------------------------------------</p>
<pre><code>AttributeError                            Traceback (most recent call last)

&lt;ipython-input-12-475d4280ae1b&gt; in &lt;module&gt;()
----&gt; 1 simulator = circuit.simulator(temperature=25, nominal_temperature=25)
      2 analysis = simulator.ac(start_frequency=1@u_Hz, stop_frequency=1@u_MHz, number_of_points=10,  variation='dec')

2 frames

/usr/local/lib/python3.6/dist-packages/PySpice/Spice/NgSpice/Simulation.py in __init__(self, circuit, **kwargs)
     97         ngspice_shared = kwargs.get('ngspice_shared', None)
     98         if ngspice_shared is None:
---&gt; 99             self._ngspice_shared = NgSpiceShared.new_instance()
    100         else:
    101             self._ngspice_shared = ngspice_shared

AttributeError: type object 'NgSpiceShared' has no attribute 'new_instance
</code></pre>
<p>the example link is as follows<br>
<a href="https://pyspice.fabrice-salvaire.fr/examples/filter/low-pass-rc-filter.html" rel="nofollow noopener">https://pyspice.fabrice-salvaire.fr/examples/filter/low-pass-rc-filter.html</a><br>
the characteristic of my environment are the following<br>
ubuntu 18.04, python 3.6.2, pyscpice 1.4.2<br>
To clarify I am a student of electrical engineering and I am just getting into this world of computer science, thank you very much for your help</p>
            <p><small>2 posts - 2 participants</small></p>
            <p><a href="https://pyspice.discourse.group/t/attributeerror-type-object-ngspiceshared-has-no-attribute-new-instance/39">Read full topic</a></p>
          ]]></description>
          <link>https://pyspice.discourse.group/t/attributeerror-type-object-ngspiceshared-has-no-attribute-new-instance/39</link>
          <pubDate>Tue, 26 May 2020 00:40:24 +0000</pubDate>
          <discourse:topicPinned>No</discourse:topicPinned>
          <discourse:topicClosed>No</discourse:topicClosed>
          <discourse:topicArchived>No</discourse:topicArchived>
          <guid isPermaLink="false">pyspice.discourse.group-topic-39</guid>
          <source url="https://pyspice.discourse.group/t/attributeerror-type-object-ngspiceshared-has-no-attribute-new-instance/39.rss">AttributeError: type object &#39;NgSpiceShared&#39; has no attribute &#39;new_instance&#39;</source>
        </item>
        <item>
          <title>Example transistor</title>
          <dc:creator><![CDATA[tadeus]]></dc:creator>
          <category>Circuit Simulation</category>
          <description><![CDATA[
            <p>good afternoon I communicate with the community because I am not very good at programming but I am trying to learn how to simulate circuits that I need for a job, however when I try to simulate the circuit of the example of transistors I get the following error</p>
<pre><code>Traceback (most recent call last):
  File "polos.py", line 50, in &lt;module&gt;
    circuit.include(spice_library['2n2222a'])
  File "/usr/local/lib/python3.6/dist-packages/PySpice/Spice/Library.py", line 107, in __getitem__
    raise KeyError(name)
KeyError: '2n2222a'</code></pre>
            <p><small>8 posts - 4 participants</small></p>
            <p><a href="https://pyspice.discourse.group/t/example-transistor/36">Read full topic</a></p>
          ]]></description>
          <link>https://pyspice.discourse.group/t/example-transistor/36</link>
          <pubDate>Fri, 22 May 2020 23:17:28 +0000</pubDate>
          <discourse:topicPinned>No</discourse:topicPinned>
          <discourse:topicClosed>No</discourse:topicClosed>
          <discourse:topicArchived>No</discourse:topicArchived>
          <guid isPermaLink="false">pyspice.discourse.group-topic-36</guid>
          <source url="https://pyspice.discourse.group/t/example-transistor/36.rss">Example transistor</source>
        </item>
        <item>
          <title>About the Circuit Simulation category</title>
          <dc:creator><![CDATA[fsalvaire]]></dc:creator>
          <category>Circuit Simulation</category>
          <description><![CDATA[
            <p>(Replace this first paragraph with a brief description of your new category. This guidance will appear in the category selection area, so try to keep it below 200 characters.)</p>
<p>Use the following paragraphs for a longer description, or to establish category guidelines or rules:</p>
<ul>
<li>
<p>Why should people use this category? What is it for?</p>
</li>
<li>
<p>How exactly is this different than the other categories we already have?</p>
</li>
<li>
<p>What should topics in this category generally contain?</p>
</li>
<li>
<p>Do we need this category? Can we merge with another category, or subcategory?</p>
</li>
</ul>
            <p><small>1 post - 1 participant</small></p>
            <p><a href="https://pyspice.discourse.group/t/about-the-circuit-simulation-category/16">Read full topic</a></p>
          ]]></description>
          <link>https://pyspice.discourse.group/t/about-the-circuit-simulation-category/16</link>
          <pubDate>Mon, 27 Apr 2020 19:48:21 +0000</pubDate>
          <discourse:topicPinned>Yes</discourse:topicPinned>
          <discourse:topicClosed>No</discourse:topicClosed>
          <discourse:topicArchived>No</discourse:topicArchived>
          <guid isPermaLink="false">pyspice.discourse.group-topic-16</guid>
          <source url="https://pyspice.discourse.group/t/about-the-circuit-simulation-category/16.rss">About the Circuit Simulation category</source>
        </item>
  </channel>
</rss>
